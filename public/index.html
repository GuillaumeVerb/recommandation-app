<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon">
    <title>Application Firebase</title>
    <!-- Inclure Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <h1 class="mt-5">Bienvenue sur l'application de recommandation de contenu</h1>

        <!-- Formulaire d'inscription -->
        <h2>Inscription</h2>
        <div class="form-group">
            <input type="email" id="signup-email" class="form-control" placeholder="Email">
        </div>
        <div class="form-group">
            <input type="password" id="signup-password" class="form-control" placeholder="Mot de passe">
        </div>
        <button id="signup-button" class="btn btn-primary">S'inscrire</button>

        <!-- Formulaire de connexion -->
        <h2 class="mt-4">Connexion</h2>
        <div class="form-group">
            <input type="email" id="login-email" class="form-control" placeholder="Email">
        </div>
        <div class="form-group">
            <input type="password" id="login-password" class="form-control" placeholder="Mot de passe">
        </div>
        <button id="login-button" class="btn btn-success">Se connecter</button>

        <!-- Section de message pour afficher des erreurs ou succès -->
        <div id="message" class="mt-4"></div>
    </div>

    <!-- Importer les SDK Firebase depuis le CDN avec "type=module" -->
    <script type="module">
        // Import des fonctions nécessaires depuis les SDK Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";

        // Configuration Firebase de ton projet
        const firebaseConfig = {
            apiKey: "AIzaSyCrG3ZLzvIpT0sCTp-uhCXJLbMrT5bb1cc",
            authDomain: "recommandation-de-conten-77ab7.firebaseapp.com",
            projectId: "recommandation-de-conten-77ab7",
            storageBucket: "recommandation-de-conten-77ab7.appspot.com",
            messagingSenderId: "47568783183",
            appId: "1:47568783183:web:56c19611c0aa72d072a73a",
            measurementId: "G-8ZTKLC39YJ"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // Déconnexion automatique lorsque la page est chargée
        auth.signOut().then(() => {
            console.log("Déconnecté automatiquement");
        }).catch((error) => {
            console.log("Erreur lors de la déconnexion : ", error);
        });

        // Fonction d'inscription
        async function signUp() {
            const email = document.getElementById('signup-email').value;
            const password = document.getElementById('signup-password').value;

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                // Afficher le message de succès
                showMessage(`Inscription réussie : ${user.email}`, 'success');
            } catch (error) {
                showMessage(`Erreur d'inscription : ${error.message}`, 'danger');
            }
        }

        // Fonction de connexion
        async function login() {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;

            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                // Afficher le message de succès
                showMessage(`Connexion réussie : ${user.email}`, 'success');
                
                // Redirection après connexion
                window.location.href = "/home.html";
            } catch (error) {
                showMessage(`Erreur de connexion : ${error.message}`, 'danger');
            }
        }

        // Fonction pour afficher les messages
        function showMessage(message, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.innerHTML = `<div class="alert alert-${type}" role="alert">${message}</div>`;
        }

        // Associer les boutons avec les fonctions JavaScript
        document.getElementById('signup-button').addEventListener('click', signUp);
        document.getElementById('login-button').addEventListener('click', login);
    </script>

    <!-- Inclure Bootstrap JS (facultatif) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</body>
</html>
